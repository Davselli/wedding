<!DOCTYPE html>
<html>
<head>
    <title>ICS File Download</title>
</head>
<body>
    <button id="downloadButton">Download Event Calendar AND2</button>

    <script>
        document.getElementById("downloadButton").addEventListener("click", function () {
            const startDate = new Date("2024-06-08T17:00:00");
            const endDate = new Date("2024-06-08T18:00:00");
            const summary = "Matrimonio Davide & Simona";
            const location = "Frontemare - Sardegna";
            const description = "Matrimonio Davide & Simona - Sabato 8 Giugno 2024 - 5:00 pm - Frontemare - Sardegna";

            const calendarData = [
                "BEGIN:VCALENDAR",
                "VERSION:2.0",
                "PRODID:-//Your Organization//Event Calendar//EN",
                "BEGIN:VEVENT",
                "UID:" + new Date().toISOString(),
                "SUMMARY:" + summary,
                "DESCRIPTION:" + description,
                "LOCATION:" + location,
                "DTSTART:" + startDate.toISOString().replace(/-|:|\.\d+/g, ""),
                "DTEND:" + endDate.toISOString().replace(/-|:|\.\d+/g, ""),
                "END:VEVENT",
                "END:VCALENDAR"
            ];

            const blob = new Blob([calendarData.join("\r\n")], { type: "text/calendar;charset=utf-8" });
            const url = window.URL.createObjectURL(blob);

            const a = document.createElement("a");
            a.href = url;
            a.download = "Matrimonio_Davide_Simona.ics";
            document.body.appendChild(a);
            a.click();

            window.URL.revokeObjectURL(url);
        });
    </script>
</body>
</html>
